<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>南投環保局空氣品質淨化區資訊網</title>
  <meta name="description" content="">
  <meta name="keywords" content="">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">

</head>

<body class="search-results-page">

  <header id="header" class="header d-flex align-items-center position-relative">
    <div class="container position-relative d-flex align-items-center justify-content-between">

      <a href="index.html" class="logo d-flex align-items-center me-auto me-xl-0">
        <!-- Uncomment the line below if you also wish to use an image logo -->
        <!-- <img src="assets/img/logo.webp" alt=""> -->
        <h1 class="sitename"><img src="assets/img/logo.png" alt="Blog Hero Image"></h1>
      </a>

      <nav id="navmenu" class="navmenu">
        <ul id="nav-dynamic"></ul>
        <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      </nav>



    </div>
  </header>

  <main class="main">

    <!-- Page Title -->
    <div class="page-title">
      <div class="heading">
        <div class="container">
          <div class="row d-flex justify-content-center text-center">
            <div class="col-lg-8">
              <h1 class="heading-title">樹種介紹</h1>
              <p class="mb-0">淨化區建置進度、活動紀錄與環境改善亮點，透過影像與文字分享南投縣推動永續的努力。透過照片、影音與文字故事，呈現綠化成果、社區參與及政策推動的點滴。</p>
            </div>
          </div>
        </div>
      </div>
      <nav class="breadcrumbs">
        <div class="container">
          <ol>
            <li><a href="index.html">首頁</a></li>
            <li class="current">樹種列表</li>
          </ol>
        </div>
      </nav>
    </div><!-- End Page Title -->

    <!-- Search Results Posts Section -->
    <section id="search-results-posts" class="search-results-posts section">

      <div class="container" data-aos="fade-up" data-aos-delay="100">
        <div class="row gy-4">

          <div class="col-6 col-lg-4">
            <article><a href="species-page.html">
              <div class="post-img img-hover-zoom">
                <img src="assets/img/species/flower.webp" alt="" class="img-fluid">
              </div>
              <p class="post-category">植物名</p>
              <h1 class="title d-flex justify-content-between align-items-center">
                <span class="plant-name">欖仁</span>
                <i class="bi bi-arrow-right-circle-fill ms-2"></i>
              </h1></a>
            </article>
          </div><!-- End post list item -->





        </div>
      </div>

    </section><!-- /Search Results Posts Section -->

    <!-- Pagination 3 Section -->
    <section id="pagination-3" class="pagination-3 section">

      <div class="container">
        <div class="d-flex justify-content-center">
          <ul>
            <li><a href="#"><i class="bi bi-chevron-left"></i></a></li>
            <li><a href="#">1</a></li>
            <li><a href="#" class="active">2</a></li>
            <li><a href="#">3</a></li>
            <li><a href="#">4</a></li>
            <li>...</li>
            <li><a href="#">10</a></li>
            <li><a href="#"><i class="bi bi-chevron-right"></i></a></li>
          </ul>
        </div>
      </div>

    </section><!-- /Pagination 3 Section -->

  </main>

  <footer id="footer" class="footer position-relative light-background">

    <div class="container">
      <div class="row gy-5">

        <div class="col-lg-4">
          <div class="footer-brand">
            <a href="index.html" class="logo d-flex align-items-center mb-3">
              <h4>南投縣政府環境保護局</h4>
            </a>
            <p class="tagline">上班(服務)時間：<br>上午 08:00-12:00；下午 13:30-17:30 <br>(週六、日及例假日休息)</p>

            <div class="social-links mt-4">
              <a href="#" aria-label="Facebook"><i class="bi bi-facebook"></i></a>
              <a href="#" aria-label="Instagram"><i class="bi bi-instagram"></i></a>
            </div>
          </div>
        </div>

        <div class="col-lg-6">
          <div class="footer-links-grid">
            <div class="row">
              <div class="col-6 col-md-4">
                <h5>首頁區塊</h5>
                <ul class="list-unstyled">
                  <li><a href="index.html#latest-posts">最新花絮</a></li>
                  <li><a href="index.html#greensituation">綠地現況</a></li>
                  <li><a href="index.html#numberbases">基地數量</a></li>
                </ul>
              </div>
              <div class="col-6 col-md-4">
                <h5>基地介紹</h5>
                <ul class="list-unstyled">
                  <li><a href="basequery.html">空氣品質淨化區</a></li>
                  <li><a href="basequery.html">清淨綠牆</a></li>
                  <li><a href="basequery.html">綠美化</a></li>
                </ul>
              </div>
              <div class="col-6 col-md-4">
                <h5>其他頁面</h5>
                <ul class="list-unstyled">
                  <li><a href="species.html">樹種介紹</a></li>
                  <li><a href="download.html">文件下載</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-2">
          <div class="footer-cta">
            <h5>聯絡我們</h5>
            <p>TEL：(049)223-7530</p>
          </div>
        </div>

      </div>
    </div>

    <div class="footer-bottom">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <div class="footer-bottom-content">
              <p class="mb-0">© <strong>南投縣政府環境保護局版權所有</strong>. All rights reserved.</p>
              <div class="credits">
                Designed by 艾可森數位學習有限公司</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </footer>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>

  <!-- Main JS File -->
  <script src="assets/js/main.js"></script>
  <script>
    (() => {
      // ==== CONFIG ====
      const API_BASE = "";              // set to "http://127.0.0.1:5000" if API runs elsewhere
      const RESOURCE = "tree_intros";   // /api/tree_intros and /api/tree_intros/:id
      const DEFAULT_PAGE_SIZE = 12;
      const DETAIL_PAGE = "species-page.html";
    
      // Read ?page & ?limit (1-based)
      const urlp  = new URLSearchParams(location.search);
      const PAGE  = Math.max(1, parseInt(urlp.get("page")  || "1", 10));
      const LIMIT = Math.max(1, parseInt(urlp.get("limit") || DEFAULT_PAGE_SIZE, 10));
    
      // Targets
      const grid      = document.querySelector('#search-results-posts .row');
      const pagerWrap = document.querySelector('#pagination-3 .container .d-flex');
    
      // Helpers
      const esc = (s) => (s == null ? "" : String(s));
      const detailURL = (id) => `${DETAIL_PAGE}?id=${encodeURIComponent(id)}`;
      const pickName = (row) =>
        row.name ?? row.common_name ?? row.chinese_name ?? row.title ?? "(未命名)";
    
      const pickImage = (row) =>
        row.image_url ?? row.photo ?? row.cover_url ?? "https://placehold.co/600x400?text=No+Image";
    
      function showAlert(msg, variant="info") {
        const container = document.querySelector("#search-results-posts .container");
        if (!container) return;
        let box = document.getElementById("species-alert");
        if (!box) {
          box = document.createElement("div");
          box.id = "species-alert";
          container.prepend(box);
        }
        box.className = `alert alert-${variant}`;
        box.textContent = msg;
      }
    
      function renderSkeleton(count = 9) {
        if (!grid) return;
        grid.innerHTML = "";
        for (let i = 0; i < count; i++) {
          const col = document.createElement("div");
          col.className = "col-6 col-lg-4";
          col.innerHTML = `
            <article class="placeholder-wave">
              <div class="post-img img-hover-zoom">
                <div class="placeholder" style="width:100%;aspect-ratio:4/3;"></div>
              </div>
              <p class="post-category placeholder col-4">&nbsp;</p>
              <h1 class="title d-flex justify-content-between align-items-center">
                <span class="plant-name placeholder col-6">&nbsp;</span>
              </h1>
            </article>`;
          grid.appendChild(col);
        }
      }
    
      function renderList(items) {
        if (!grid) return;
        grid.innerHTML = "";
    
        if (!Array.isArray(items) || items.length === 0) {
          grid.innerHTML = `<div class="col-12"><div class="alert alert-secondary">目前沒有樹種資料。</div></div>`;
          return;
        }
    
        items.forEach((row, idx) => {
          const id    = row.id;
          const name  = pickName(row);
          const img   = pickImage(row);
    
          const col = document.createElement("div");
          col.className = "col-6 col-lg-4";
          col.setAttribute("data-aos", "fade-up");
          col.setAttribute("data-aos-delay", String(100 + 25 * (idx % 6)));
    
          col.innerHTML = `
            <article>
              <a href="${detailURL(id)}">
                <div class="post-img img-hover-zoom">
                  <img src="${esc(img)}" alt="${esc(name)}" class="img-fluid">
                </div>
                <p class="post-category">植物名</p>
                <h1 class="title d-flex justify-content-between align-items-center">
                  <span class="plant-name">${esc(name)}</span>
                  <i class="bi bi-arrow-right-circle-fill ms-2"></i>
                </h1>
              </a>
            </article>`;
          grid.appendChild(col);
        });
      }
    
      function renderPagination({ page, totalPages }) {
        if (!pagerWrap) return;
        const ul = document.createElement("ul");
    
        const addLink = (label, p, active=false, disabled=false) => {
          const li = document.createElement("li");
          const a  = document.createElement("a");
          a.href = disabled ? "#" : `?page=${p}&limit=${LIMIT}`;
          if (active) a.className = "active";
          a.innerHTML = label;
          if (disabled) a.setAttribute("aria-disabled", "true");
          li.appendChild(a);
          ul.appendChild(li);
        };
    
        addLink('<i class="bi bi-chevron-left"></i>', Math.max(1, page - 1), false, page === 1);
    
        const windowSize = 5;
        let start = Math.max(1, page - Math.floor(windowSize / 2));
        let end   = Math.min(totalPages, start + windowSize - 1);
        if (end - start + 1 < windowSize) start = Math.max(1, end - windowSize + 1);
    
        if (start > 1) addLink("1", 1);
        if (start > 2) { const dot = document.createElement("li"); dot.textContent = "..."; ul.appendChild(dot); }
    
        for (let p = start; p <= end; p++) addLink(String(p), p, p === page);
    
        if (end < totalPages - 1) { const dot = document.createElement("li"); dot.textContent = "..."; ul.appendChild(dot); }
        if (end < totalPages) addLink(String(totalPages), totalPages);
    
        addLink('<i class="bi bi-chevron-right"></i>', Math.min(totalPages, page + 1), false, page === totalPages);
    
        pagerWrap.innerHTML = "";
        pagerWrap.appendChild(ul);
      }
    
      // Data loaders (server returns full array; we paginate client-side)
      async function fetchAllThenSlice() {
        const res = await fetch(`${API_BASE}/api/${RESOURCE}`, { credentials: "same-origin" });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const all = await res.json();  // expecting an array of rows: { id, name?, image_url?, ... }
        const total = Array.isArray(all) ? all.length : 0;
        const start = (PAGE - 1) * LIMIT;
        const pageItems = (Array.isArray(all) ? all : []).slice(start, start + LIMIT);
        return { items: pageItems, page: PAGE, total, totalPages: Math.max(1, Math.ceil(total / LIMIT)) };
      }
    
      (async function init() {
        renderSkeleton(9);
        showAlert("載入中…", "info");
        try {
          const payload = await fetchAllThenSlice();
          renderList(payload.items);
          renderPagination({ page: payload.page, totalPages: payload.totalPages });
          showAlert("載入完成", "success");
          setTimeout(() => document.getElementById("species-alert")?.remove(), 1200);
        } catch (err) {
          console.error(err);
          showAlert("載入樹種列表失敗，請稍後再試。", "danger");
          if (grid) grid.innerHTML = "";
        }
      })();
    })();
    </script>
    <script>
      (async () => {
  const API_BASE = ""; // same origin (if Flask runs at same port)
  const ul = document.getElementById("nav-dynamic");
  if (!ul) return;
  
  // 1️⃣ Fetch visible sections
  let sections = [];
  try {
    const res = await fetch(`${API_BASE}/api/site/sections`, { credentials: "same-origin" });
    if (res.ok) sections = await res.json();
  } catch (err) {
    console.error("Failed to load site sections:", err);
  }
  
  // 2️⃣ Build dropdown only for visible ones
  const visible = sections.filter(s => s.is_visible);
  if (visible.length > 0) {
    const li = document.createElement("li");
    li.className = "dropdown";
  
    const dropdownToggle = `
      <a href="#"><span>基地介紹</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
    `;
    const subUl = document.createElement("ul");
  
    visible.forEach(sec => {
      const label = sec.label;
      const a = document.createElement("a");
      a.href = `basequery.html?type=${encodeURIComponent(label)}`;
      a.textContent = label;
      const liSub = document.createElement("li");
      liSub.appendChild(a);
      subUl.appendChild(liSub);
    });
  
    li.innerHTML = dropdownToggle;
    li.appendChild(subUl);
    ul.appendChild(li);
  }
  
  // 3️⃣ Append the static parts (always present)
  const staticLinks = [
    { label: "最新成果", href: "articles.html" },
    { label: "樹種介紹", href: "species.html" },
    { label: "文件下載", href: "download.html" },
  ];
  
  staticLinks.forEach(item => {
    const li = document.createElement("li");
    li.innerHTML = `<a href="${item.href}">${item.label}</a>`;
    ul.appendChild(li);
  });
  })();
    </script>
    

</body>

</html>